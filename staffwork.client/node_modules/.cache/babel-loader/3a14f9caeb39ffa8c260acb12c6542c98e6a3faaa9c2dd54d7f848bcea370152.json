{"ast":null,"code":"import Node from '../core/Node.js';\nimport LightingNode from './LightingNode.js';\nconst references = new WeakMap();\nconst sortLights = lights => {\n  return lights.sort((a, b) => a.id - b.id);\n};\nclass LightsNode extends Node {\n  constructor() {\n    let lightNodes = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    super('vec3');\n    this.lightNodes = lightNodes;\n    this._hash = null;\n  }\n  get hasLight() {\n    return this.lightNodes.length > 0;\n  }\n  construct(builder) {\n    const lightNodes = this.lightNodes;\n    for (const lightNode of lightNodes) {\n      lightNode.build(builder);\n    }\n  }\n  getHash(builder) {\n    if (this._hash === null) {\n      let hash = '';\n      const lightNodes = this.lightNodes;\n      for (const lightNode of lightNodes) {\n        hash += lightNode.getHash(builder) + ' ';\n      }\n      this._hash = hash;\n    }\n    return this._hash;\n  }\n  getLightNodeByHash(hash) {\n    const lightNodes = this.lightNodes;\n    for (const lightNode of lightNodes) {\n      if (lightNode.light.uuid === hash) {\n        return lightNode;\n      }\n    }\n    return null;\n  }\n  fromLights(lights) {\n    const lightNodes = [];\n    lights = sortLights(lights);\n    for (const light of lights) {\n      let lightNode = this.getLightNodeByHash(light.uuid);\n      if (lightNode === null) {\n        const lightClass = light.constructor;\n        const lightNodeClass = references.has(lightClass) ? references.get(lightClass) : LightingNode;\n        lightNode = new lightNodeClass(light);\n      }\n      lightNodes.push(lightNode);\n    }\n    this.lightNodes = lightNodes;\n    this._hash = null;\n    return this;\n  }\n  static setReference(lightClass, lightNodeClass) {\n    references.set(lightClass, lightNodeClass);\n  }\n}\nexport default LightsNode;","map":{"version":3,"names":["Node","LightingNode","references","WeakMap","sortLights","lights","sort","a","b","id","LightsNode","constructor","lightNodes","_hash","hasLight","length","construct","builder","lightNode","build","getHash","hash","getLightNodeByHash","light","uuid","fromLights","lightClass","lightNodeClass","has","get","push","setReference","set"],"sources":["C:/Users/dro1l/source/repos/StaffWork/staffwork.client/node_modules/three/examples/jsm/nodes/lighting/LightsNode.js"],"sourcesContent":["import Node from '../core/Node.js';\nimport LightingNode from './LightingNode.js';\n\nconst references = new WeakMap();\n\nconst sortLights = ( lights ) => {\n\n\treturn lights.sort( ( a, b ) => a.id - b.id );\n\n};\n\nclass LightsNode extends Node {\n\n\tconstructor( lightNodes = [] ) {\n\n\t\tsuper( 'vec3' );\n\n\t\tthis.lightNodes = lightNodes;\n\n\t\tthis._hash = null;\n\n\t}\n\n\tget hasLight() {\n\n\t\treturn this.lightNodes.length > 0;\n\n\t}\n\n\tconstruct( builder ) {\n\n\t\tconst lightNodes = this.lightNodes;\n\n\t\tfor ( const lightNode of lightNodes ) {\n\n\t\t\tlightNode.build( builder );\n\n\t\t}\n\n\t}\n\n\tgetHash( builder ) {\n\n\t\tif ( this._hash === null ) {\n\n\t\t\tlet hash = '';\n\n\t\t\tconst lightNodes = this.lightNodes;\n\n\t\t\tfor ( const lightNode of lightNodes ) {\n\n\t\t\t\thash += lightNode.getHash( builder ) + ' ';\n\n\t\t\t}\n\n\t\t\tthis._hash = hash;\n\n\t\t}\n\n\t\treturn this._hash;\n\n\t}\n\n\tgetLightNodeByHash( hash ) {\n\n\t\tconst lightNodes = this.lightNodes;\n\n\t\tfor ( const lightNode of lightNodes ) {\n\n\t\t\tif ( lightNode.light.uuid === hash ) {\n\n\t\t\t\treturn lightNode;\n\n\t\t\t}\n\n\t\t}\n\n\t\treturn null;\n\n\t}\n\n\tfromLights( lights ) {\n\n\t\tconst lightNodes = [];\n\n\t\tlights = sortLights( lights );\n\n\t\tfor ( const light of lights ) {\n\n\t\t\tlet lightNode = this.getLightNodeByHash( light.uuid );\n\n\t\t\tif ( lightNode === null ) {\n\n\t\t\t\tconst lightClass = light.constructor;\n\t\t\t\tconst lightNodeClass = references.has( lightClass ) ? references.get( lightClass ) : LightingNode;\n\n\t\t\t\tlightNode = new lightNodeClass( light );\n\n\t\t\t}\n\n\t\t\tlightNodes.push( lightNode );\n\n\t\t}\n\n\t\tthis.lightNodes = lightNodes;\n\t\tthis._hash = null;\n\n\t\treturn this;\n\n\t}\n\n\tstatic setReference( lightClass, lightNodeClass ) {\n\n\t\treferences.set( lightClass, lightNodeClass );\n\n\t}\n\n}\n\nexport default LightsNode;\n"],"mappings":"AAAA,OAAOA,IAAI,MAAM,iBAAiB;AAClC,OAAOC,YAAY,MAAM,mBAAmB;AAE5C,MAAMC,UAAU,GAAG,IAAIC,OAAO,EAAE;AAEhC,MAAMC,UAAU,GAAKC,MAAM,IAAM;EAEhC,OAAOA,MAAM,CAACC,IAAI,CAAE,CAAEC,CAAC,EAAEC,CAAC,KAAMD,CAAC,CAACE,EAAE,GAAGD,CAAC,CAACC,EAAE,CAAE;AAE9C,CAAC;AAED,MAAMC,UAAU,SAASV,IAAI,CAAC;EAE7BW,WAAW,GAAoB;IAAA,IAAlBC,UAAU,uEAAG,EAAE;IAE3B,KAAK,CAAE,MAAM,CAAE;IAEf,IAAI,CAACA,UAAU,GAAGA,UAAU;IAE5B,IAAI,CAACC,KAAK,GAAG,IAAI;EAElB;EAEA,IAAIC,QAAQ,GAAG;IAEd,OAAO,IAAI,CAACF,UAAU,CAACG,MAAM,GAAG,CAAC;EAElC;EAEAC,SAAS,CAAEC,OAAO,EAAG;IAEpB,MAAML,UAAU,GAAG,IAAI,CAACA,UAAU;IAElC,KAAM,MAAMM,SAAS,IAAIN,UAAU,EAAG;MAErCM,SAAS,CAACC,KAAK,CAAEF,OAAO,CAAE;IAE3B;EAED;EAEAG,OAAO,CAAEH,OAAO,EAAG;IAElB,IAAK,IAAI,CAACJ,KAAK,KAAK,IAAI,EAAG;MAE1B,IAAIQ,IAAI,GAAG,EAAE;MAEb,MAAMT,UAAU,GAAG,IAAI,CAACA,UAAU;MAElC,KAAM,MAAMM,SAAS,IAAIN,UAAU,EAAG;QAErCS,IAAI,IAAIH,SAAS,CAACE,OAAO,CAAEH,OAAO,CAAE,GAAG,GAAG;MAE3C;MAEA,IAAI,CAACJ,KAAK,GAAGQ,IAAI;IAElB;IAEA,OAAO,IAAI,CAACR,KAAK;EAElB;EAEAS,kBAAkB,CAAED,IAAI,EAAG;IAE1B,MAAMT,UAAU,GAAG,IAAI,CAACA,UAAU;IAElC,KAAM,MAAMM,SAAS,IAAIN,UAAU,EAAG;MAErC,IAAKM,SAAS,CAACK,KAAK,CAACC,IAAI,KAAKH,IAAI,EAAG;QAEpC,OAAOH,SAAS;MAEjB;IAED;IAEA,OAAO,IAAI;EAEZ;EAEAO,UAAU,CAAEpB,MAAM,EAAG;IAEpB,MAAMO,UAAU,GAAG,EAAE;IAErBP,MAAM,GAAGD,UAAU,CAAEC,MAAM,CAAE;IAE7B,KAAM,MAAMkB,KAAK,IAAIlB,MAAM,EAAG;MAE7B,IAAIa,SAAS,GAAG,IAAI,CAACI,kBAAkB,CAAEC,KAAK,CAACC,IAAI,CAAE;MAErD,IAAKN,SAAS,KAAK,IAAI,EAAG;QAEzB,MAAMQ,UAAU,GAAGH,KAAK,CAACZ,WAAW;QACpC,MAAMgB,cAAc,GAAGzB,UAAU,CAAC0B,GAAG,CAAEF,UAAU,CAAE,GAAGxB,UAAU,CAAC2B,GAAG,CAAEH,UAAU,CAAE,GAAGzB,YAAY;QAEjGiB,SAAS,GAAG,IAAIS,cAAc,CAAEJ,KAAK,CAAE;MAExC;MAEAX,UAAU,CAACkB,IAAI,CAAEZ,SAAS,CAAE;IAE7B;IAEA,IAAI,CAACN,UAAU,GAAGA,UAAU;IAC5B,IAAI,CAACC,KAAK,GAAG,IAAI;IAEjB,OAAO,IAAI;EAEZ;EAEA,OAAOkB,YAAY,CAAEL,UAAU,EAAEC,cAAc,EAAG;IAEjDzB,UAAU,CAAC8B,GAAG,CAAEN,UAAU,EAAEC,cAAc,CAAE;EAE7C;AAED;AAEA,eAAejB,UAAU"},"metadata":{},"sourceType":"module","externalDependencies":[]}