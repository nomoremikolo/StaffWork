{"ast":null,"code":"import React,{useEffect}from'react';import{useAppDispatch,useAppSelector}from\"../../hooks/redux\";import ReactDOM from\"react-dom\";import{Modal}from\"react-bootstrap\";import{DashCircle,Heartbreak,PlusCircle,XLg}from\"react-bootstrap-icons\";import{changeBasketWareCount,confirmOrder,fetch_cart_wares,removeFromBasket}from\"../../redux/action_creators/ware_action_creator\";import{Link}from\"react-router-dom\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var CartModal=function CartModal(_ref){var show=_ref.show,closeHandler=_ref.closeHandler;var dispatch=useAppDispatch();var _useAppSelector=useAppSelector(function(state){return state.authorizationReducer;}),isAuthorized=_useAppSelector.isAuthorized;var _useAppSelector2=useAppSelector(function(state){return state.wareReducer;}),cartWares=_useAppSelector2.cartWares;useEffect(function(){dispatch(fetch_cart_wares());},[]);useEffect(function(){dispatch(fetch_cart_wares());},[show]);if(!show)return null;return/*#__PURE__*/ReactDOM.createPortal(/*#__PURE__*/_jsxs(Modal,{show:show,onHide:closeHandler,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Cart\"})}),/*#__PURE__*/_jsxs(Modal.Body,{children:[!isAuthorized?/*#__PURE__*/_jsxs(\"h3\",{className:'text-center my-4',children:[\"\\u0412\\u0438 \\u043D\\u0435 \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u043D\\u0456 \",/*#__PURE__*/_jsx(Heartbreak,{className:'mb-1'})]}):/*#__PURE__*/_jsx(_Fragment,{}),!isAuthorized?/*#__PURE__*/_jsxs(\"h3\",{className:'text-center my-4',children:[\"\\u0412\\u0438 \\u043D\\u0435 \\u0430\\u0432\\u0442\\u043E\\u0440\\u0438\\u0437\\u043E\\u0432\\u0430\\u043D\\u0456 \",/*#__PURE__*/_jsx(Heartbreak,{className:'mb-1'})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[cartWares.length>0?cartWares.map(function(item){return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"card w-75 mx-auto mb-3\",children:[/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){dispatch(removeFromBasket(item.id));dispatch(fetch_cart_wares());},className:\"p-0 btn btn-secondary position-absolute top-0 end-0 mt-3 me-3\",children:/*#__PURE__*/_jsx(XLg,{height:20,width:20})}),/*#__PURE__*/_jsx(\"img\",{style:{\"width\":\"80%\",\"margin\":\"auto\"},src:\"https://www.staff-clothes.com/_next/image/?url=https%3A%2F%2Fstatic.staff-clothes.com%2Fmedia%2Fcache%2Fimage_product_desktop_catalog%2Fimage_product%2F0002%2F73%2Fe3b0187358014ffeadec729c7f0beebf.jpeg&w=1920&q=75\",className:\"card-img-top\",alt:\"...\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"h5\",{className:\"card-title\",children:item.name}),/*#__PURE__*/_jsx(\"p\",{className:\"card-text\",children:item.sizes}),/*#__PURE__*/_jsxs(\"p\",{className:\"card-text\",children:[item.price,\" \\u0433\\u0440\\u043D.\"]}),item.isDiscount?/*#__PURE__*/_jsx(\"p\",{className:\"card-text\",children:/*#__PURE__*/_jsxs(\"del\",{children:[item.oldPrice,\" \\u0433\\u0440\\u043D.\"]})}):/*#__PURE__*/_jsx(_Fragment,{}),/*#__PURE__*/_jsx(Link,{onClick:closeHandler,to:\"/Wares/\".concat(item.id),className:\"btn btn-primary\",children:\"More\"}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){var _e$currentTarget$next;var count=Number((_e$currentTarget$next=e.currentTarget.nextSibling)===null||_e$currentTarget$next===void 0?void 0:_e$currentTarget$next.innerHTML);if(count<item.countInStorage){dispatch(changeBasketWareCount(item.id,Number(e.currentTarget.nextSibling.innerHTML)+1));e.currentTarget.nextSibling.innerHTML=Number(e.currentTarget.nextSibling.innerHTML)+1;}},className:'btn btn-secondary mb-1 ms-3 me-3 p-0',children:/*#__PURE__*/_jsx(PlusCircle,{height:20,width:20})}),/*#__PURE__*/_jsx(\"p\",{className:'d-inline',children:item.count}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(e){var _e$currentTarget$prev;var count=Number((_e$currentTarget$prev=e.currentTarget.previousElementSibling)===null||_e$currentTarget$prev===void 0?void 0:_e$currentTarget$prev.innerHTML);if(count>1){dispatch(changeBasketWareCount(item.id,count-1));e.currentTarget.previousElementSibling.innerHTML=count-1;}},className:'btn btn-secondary mb-1 ms-3 p-0',children:/*#__PURE__*/_jsx(DashCircle,{height:20,width:20})})]})]})});}):/*#__PURE__*/_jsx(\"p\",{children:\"Oops, it's empty\"}),/*#__PURE__*/_jsx(\"div\",{className:\"modal-footer\",children:/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){dispatch(confirmOrder(function(){return dispatch(fetch_cart_wares());}));},type:\"button\",className:\"btn btn-primary\",children:\"Confirm order\"})})]})]})]}),document.getElementById('root'));};export default CartModal;","map":{"version":3,"names":["React","useEffect","useAppDispatch","useAppSelector","ReactDOM","Modal","DashCircle","Heartbreak","PlusCircle","XLg","changeBasketWareCount","confirmOrder","fetch_cart_wares","removeFromBasket","Link","CartModal","show","closeHandler","dispatch","state","authorizationReducer","isAuthorized","wareReducer","cartWares","createPortal","length","map","item","id","name","sizes","price","isDiscount","oldPrice","e","count","Number","currentTarget","nextSibling","innerHTML","countInStorage","previousElementSibling","document","getElementById"],"sources":["C:/Users/dro1l/source/repos/StaffWork/staffwork.client/src/pages/Layout/CartModal.tsx"],"sourcesContent":["import React, {FC, useEffect} from 'react';\r\nimport {useAppDispatch, useAppSelector} from \"../../hooks/redux\";\r\nimport ReactDOM from \"react-dom\";\r\nimport {Modal} from \"react-bootstrap\";\r\nimport {Basket, DashCircle, Heartbreak, PlusCircle, XLg} from \"react-bootstrap-icons\";\r\nimport {\r\n    changeBasketWareCount, confirmOrder,\r\n    fetch_cart_wares,\r\n    removeFromBasket\r\n} from \"../../redux/action_creators/ware_action_creator\";\r\nimport {Link} from \"react-router-dom\";\r\n\r\ninterface ICardModal {\r\n    show: boolean,\r\n    closeHandler: () => void,\r\n}\r\n\r\nconst CartModal: FC<ICardModal> = ({show, closeHandler}) => {\r\n    const dispatch = useAppDispatch()\r\n    const {isAuthorized} = useAppSelector(state => state.authorizationReducer)\r\n    const {cartWares} = useAppSelector(state => state.wareReducer)\r\n    useEffect(() => {\r\n        dispatch(fetch_cart_wares())\r\n    }, [])\r\n    useEffect(() => {\r\n        dispatch(fetch_cart_wares())\r\n    }, [show])\r\n    if (!show) return null\r\n    return ReactDOM.createPortal(\r\n        <Modal show={show} onHide={closeHandler}>\r\n            <Modal.Header closeButton>\r\n                <Modal.Title>Cart</Modal.Title>\r\n            </Modal.Header>\r\n            <Modal.Body>\r\n                {!isAuthorized ?\r\n                    <h3 className={'text-center my-4'}>Ви не авторизовані <Heartbreak className={'mb-1'}/></h3> : <></>}\r\n                {!isAuthorized ?\r\n                    <h3 className={'text-center my-4'}>Ви не авторизовані <Heartbreak className={'mb-1'}/></h3> :\r\n                    <>\r\n                        {cartWares.length > 0 ?\r\n                            cartWares.map(item => (\r\n                                    <>\r\n                                        <div className=\"card w-75 mx-auto mb-3\">\r\n                                            <button onClick={() => {dispatch(removeFromBasket(item.id));dispatch(fetch_cart_wares())}} className={\"p-0 btn btn-secondary position-absolute top-0 end-0 mt-3 me-3\"}><XLg height={20} width={20}/></button>\r\n                                            <img style={{\"width\": \"80%\", \"margin\": \"auto\"}}\r\n                                                 src={\"https://www.staff-clothes.com/_next/image/?url=https%3A%2F%2Fstatic.staff-clothes.com%2Fmedia%2Fcache%2Fimage_product_desktop_catalog%2Fimage_product%2F0002%2F73%2Fe3b0187358014ffeadec729c7f0beebf.jpeg&w=1920&q=75\"}\r\n                                                 className=\"card-img-top\" alt=\"...\"/>\r\n                                            <div className=\"card-body\">\r\n                                                <h5 className=\"card-title\">{item.name}</h5>\r\n                                                <p className=\"card-text\">{item.sizes}</p>\r\n                                                <p className=\"card-text\">{item.price} грн.</p>\r\n                                                {item.isDiscount ? <p className=\"card-text\">\r\n                                                    <del>{item.oldPrice} грн.</del>\r\n                                                </p> : <></>\r\n                                                }\r\n                                                <Link onClick={closeHandler} to={`/Wares/${item.id!}`}\r\n                                                      className=\"btn btn-primary\">More</Link>\r\n                                                <button onClick={(e: any) => {\r\n                                                    let count = Number(e.currentTarget.nextSibling?.innerHTML)\r\n                                                    if(count < item.countInStorage){\r\n                                                        dispatch(changeBasketWareCount(item.id, Number(e.currentTarget.nextSibling.innerHTML) + 1))\r\n                                                        e.currentTarget.nextSibling.innerHTML = Number(e.currentTarget.nextSibling.innerHTML) + 1\r\n                                                    }\r\n                                                }\r\n                                                } className={'btn btn-secondary mb-1 ms-3 me-3 p-0'}><PlusCircle height={20} width={20}/></button>\r\n                                                <p className={'d-inline'}>{item.count}</p>\r\n                                                <button onClick={(e: any) => {\r\n                                                    let count = Number(e.currentTarget.previousElementSibling?.innerHTML)\r\n                                                    if(count > 1){\r\n                                                        dispatch(changeBasketWareCount(item.id, count - 1));\r\n                                                        e.currentTarget.previousElementSibling.innerHTML = count - 1\r\n                                                    }\r\n                                                }} className={'btn btn-secondary mb-1 ms-3 p-0'}><DashCircle height={20} width={20}/></button>\r\n                                            </div>\r\n                                        </div>\r\n                                    </>\r\n                                )\r\n                            )\r\n                            : <p>Oops, it's empty</p>}\r\n                        <div className=\"modal-footer\">\r\n                            <button onClick={() => {dispatch(confirmOrder(() => dispatch(fetch_cart_wares())))}} type=\"button\" className=\"btn btn-primary\">Confirm order</button>\r\n                        </div>\r\n                    </>\r\n                }\r\n            </Modal.Body>\r\n        </Modal>,\r\n        document.getElementById('root') as HTMLElement\r\n    );\r\n};\r\n\r\nexport default CartModal;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}